<app-intro class="layout"></app-intro>
<div class="layout layout--body">
  <div class="layout-content">
    <div class="box box--intro">
      <h3 class="box-title" id="/user-centric-metrics/">
        <a href="{{ path }}#/user-centric-metrics/">User-centric performance metrics</a>
      </h3>
      <p><b>Perfume</b> leverage the latest W3C Performance Drafts (like PerformanceObserver), for measuring performance that matters! </p>
      <ul>
        <li>First Paint (FP)</li>
        <li>First Contentful Paint (FCP)</li>
        <li>First Input Delay (FID)</li>
      </ul>
      <picture class="box-img">
        <source srcset="{{ path }}assets/first-paint-and-first-input-delay.webp" type="image/webp" />
        <source srcset="{{ path }}assets/first-paint-and-first-input-delay.png" type="image/png" />
        <img src="{{ path }}assets/first-paint-and-first-input-delay.png" alt="first paint and first input delay" />
      </picture>
    </div>

    <div class="box">
      <h3 class="box-title" id="/installing-and-imports/">
        <a href="{{ path }}#/installing-and-imports/">Installing and Imports</a>
      </h3>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="gray">// Install</span>
npm install perfume.js --save-dev

<span class="gray">// Importing library</span>
<span class="gray">// Import the generated bundle to use the whole library generated by this starter:</span>
<span class="red">import</span> Perfume <span class="red">from</span> 'perfume.js';

<span class="gray">// Import the transpiled modules from `dist/es` in case you have a modular library:</span>
<span class="red">import</span> Perfume <span class="red">from</span> 'node_modules/perfume.js/dist/es/perfume';

<span class="gray">// Universal Module Definition:</span>
<span class="red">import</span> Perfume <span class="red">from</span> 'node_modules/perfume.js/perfume.umd.js'; </pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="box">
      <h2 class="box-title">Start measuring</h2>
    </div>

    <div class="box">
      <h3 class="box-title" id="/first-paint/">
        <a href="{{ path }}#/first-paint/">
          First Paint (FP)
        </a>
      </h3>
      <p>FP is the exact time the browser renders anything as visually different from what was
      on the screen before navigation, e.g. a background change after a long blank white screen time.</p>
      <p class="box-demo">
        Perfume.js: First Paint {{ perfume.firstPaintDuration }} ms
      </p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="red">const</span> <span class="blue">perfume</span> <span class="red">= new</span> <span class="violet">Perfume</span>({{'{'}}
  firstPaint<span class="red">:</span> <span class="blue">true</span>
{{'}'}});
<span class="gray">// Perfume.js: First Paint 1482.00 ms</span></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="box">
      <h3 class="box-title" id="/first-contentful-paint/">
        <a href="{{ path }}#/first-contentful-paint/">
          First Contentful Paint (FCP)
        </a>
      </h3>
      <p>FCP is the exact time the browser renders the first bit of content from the DOM, which can be anything from an important image, text, or even the small SVG at the bottom of the page.</p>
      <p class="box-demo">
        Perfume.js: First Contentful Paint {{ firstContentfulPaint || 0 }} ms
      </p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="red">const</span> <span class="blue">perfume</span> <span class="red">= new</span> <span class="violet">Perfume</span>({{'{'}}
  firstContentfulPaint<span class="red">:</span> <span class="blue">true</span>
{{'}'}});
<span class="gray">// Perfume.js: First Contentful Paint 2029.00 ms</span></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="box">
      <h3 class="box-title" id="/first-input-delay/">
        <a href="{{ path }}#/first-input-delay/">First Input Delay (FID)</a>
      </h3>
      <p>
        <b>FID</b> measures the time from when a user first interacts with your site 
        (i.e. when they click a link, tap on a button) to the time when the browser is actually 
        able to respond to that interaction..
      </p>
      <p class="box-demo">
        Perfume.js: First Input Delay {{ firstInputDelay || 0 }} ms
      </p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="red">const</span> <span class="blue">perfume</span> <span class="red">= new</span> <span class="violet">Perfume</span>({{'{'}}
  firstInputDelay<span class="red">:</span> <span class="blue">true</span>
{{'}'}});
<span class="gray">// Perfume.js: First Input Delay 3.20 ms</span></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="box">
      <h3 class="box-title" id="/annotate-metrics/">
        <a href="{{ path }}#/annotate-metrics/">Annotate metrics in the DevTools</a>
      </h3>
      <p>
        <b>Performance.mark</b> (
        <a href="https://developer.mozilla.org/en-US/docs/Web/API/User_Timing_API" target="_blank">User Timing API</a>) is used to create an application-defined peformance entry in the browser's performance entry
        buffer.
      </p>
      <p class="box-demo">
        <button class="box-demo-btn" (click)="measureFibonacci()">Run Fibonacci</button>
        <span>{{ logFibonacci }}</span>
      </p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre>perfume.<span class="blue">start</span>('fibonacci');
<span class="violet">fibonacci</span>(<span class="blue">400</span>);
perfume.<span class="violet">end</span>('fibonacci');
<span class="gray">// Perfume.js: fibonacci 0.14 ms</span></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <picture class="box-img">
        <source srcset="{{ path }}assets/performance-mark.webp" type="image/webp" />
        <source srcset="{{ path }}assets/performance-mark.png" type="image/png" />
        <img src="{{ path }}assets/performance-mark.png" alt="Annotate metrics in the DevTools" />
      </picture>
    </div>

    <app-cfp class="box" id="/component-first-paint/"></app-cfp>

    <div class="box">
      <h3 class="box-title" id="/custom-logging/">
        <a href="{{ path }}#/custom-logging/">Custom Logging</a>
      </h3>
      <p>Save the duration and print it out exactly the way you want it.</p>
      <p class="box-demo">
        <button class="box-demo-btn" (click)="customLogging()">Run custom logging</button>
        <span>{{ logCustom }}</span>
      </p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="red">const</span> <span class="blue">perfume</span> <span class="red">= new</span> <span class="violet">Perfume</span>({{'{'}}
  logPrefix<span class="red">:</span> "üçπ HayesValley.js"
{{'}'}});

perfume.<span class="blue">start</span>('fibonacci');
<span class="violet">fibonacci</span>(<span class="blue">400</span>);
<span class="red">const</span> duration <span class="red">=</span> perfume.<span class="violet">end</span>('fibonacci');
perfume.<span class="violet">log</span>('Custom logging', duration);
<span class="gray">// üçπ HayesValley.js: Custom logging 0.14 ms</span></pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="box">
      <h2 class="box-title">Frameworks</h2>
    </div>

    <div class="box">
      <h3 class="box-title" id="/angular/">
        <a href="{{ path }}#/angular/">Angular</a>
      </h3>
      <p>
        In combination with the Angular framework, we can start configuring Perfume to collect the initial 
        performance metrics of the application. Make sure to import the <b>PefumeModule</b> 
        at first inside the <b>NgModule</b> to let the PerformanceObserver work correctly.
      </p>
      <p>
        In a large application use the  <b>@PerfumeAfterViewInit()</b> decorator to monitor the rendering 
        performance of the most complex components. Avoid using it inside a NgFor, 
        instead focus on components that include a collection of smaller components.
      </p>
      <p>
        The <b>NgPerfume</b> service exposes all the methods and property of the <b>perfume</b> instance,
        use it to annotate a distinct coding flow manually and for unit test mocking.
      </p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="red">import</span> {{'{'}}
  {{ 'NgPerfume, 
  PerfumeModule' }},
  PerfumeAfterViewInit
{{'}'}} <span class="red">from</span> 'perfume.js/angular';
<span class="red">import</span> {{'{'}} AppComponent {{'}'}} <span class="red">from</span> './app.component';

@<span class="green">Component</span>({{'{'}}
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.less'],
{{'}'}})
@<span class="green">PerfumeAfterViewInit</span>('AppComponent')
<span class="red">export</span> <span class="blue">class</span> <span class="green">AppComponent</span> <span class="red">implements</span> <span class="green">AfterViewInit</span> {{'{'}}
  <span class="blue">constructor</span>(<span class="red">public</span> perfume<span class="red">:</span> NgPerfume) {{'{}'}}
  <span class="green">ngAfterViewInit</span>() {{'{}'}}
  <span class="green">launchFalconNine</span>() {{'{'}}
    this.perfume.<span class="blue">start</span>('rocketScience');
    <span class="gray">// Rocket Science Match ...</span>
    this.perfume.<span class="violet">end</span>('rocketScience');
  {{'}'}}
{{'}'}}

<span class="gray">// Perfume.js config, supports AOT and DI</span>
<span class="red">export</span> <span class="blue">const</span> PerfumeConfig <span class="red">=</span> {{'{'}}
  firstContentfulPaint: <span class="blue">true</span>,
  firstInputDelay: <span class="blue">true</span>,
{{'}'}};

@<span class="green">NgModule</span>({{'{'}}
  declarations: [AppComponent],
  imports: [{{ 'PerfumeModule' }}.<span class="green">forRoot</span>(PerfumeConfig)],
  bootstrap: [AppComponent],
{{'}'}})
<span class="red">export</span> <span class="blue">class</span> <span class="green">AppModule</span> {{'{}'}}</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <picture class="box-img">
        <source srcset="{{ path }}assets/angular-performance-decorator.webp" type="image/webp" />
        <source srcset="{{ path }}assets/angular-performance-decorator.png" type="image/png" />
        <img src="{{ path }}assets/angular-performance-decorator.png" alt="Angular Performance Decorator" />
      </picture>
    </div>

    <div class="box">
      <h2 class="box-title">Analytics</h2>
    </div>

    <div class="box">
      <h3 class="box-title" id="/google-analytics/">
        <a href="{{ path }}#/google-analytics/">Google Analytics</a>
      </h3>
      <p>To enable Perfume to send your measures to Google Analytics User timing, set the option
        <b>enable:true</b> and a custom
        <a href="https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#timingVar" target="_blank">user timing variable</a>
        <b>timingVar:"name"</b>.
      </p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="red">const</span> <span class="blue">perfume</span> <span class="red">= new</span> <span class="violet">Perfume</span>({{'{'}}
  googleAnalytics<span class="red">:</span> {{'{'}}
    enable<span class="red">:</span> <span class="blue">true</span>,
    timingVar<span class="red">:</span> "userId"
  {{'}'}}
{{'}'}});</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <picture class="box-img">
        <source srcset="{{ path }}assets/performance-analytics.webp" type="image/webp" />
        <source srcset="{{ path }}assets/performance-analytics.png" type="image/png" />
        <img src="{{ path }}assets/performance-analytics.png" alt="Google Analytics User timing" />
      </picture>
    </div>

    <div class="box">
      <h3 class="box-title" id="/analytics-support/">
        <a href="{{ path }}#/analytics-support/">Generic analytics platform support</a>
      </h3>
      <p>Configurable analytics callback to use Perfume.js with any platform.</p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="red">const</span> <span class="blue">perfume</span> <span class="red">= new</span> <span class="violet">Perfume</span>({{'{'}}
  <span class="violet">analyticsTracker</span><span class="red">:</span> (metricName, duration) => {{'{'}}
    myAnalyticsTool.<span class="violet">track</span>(metricName, duration);
  {{'}'}})
{{'}'}});</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="box">
      <h2 class="box-title">Customize & Utilities</h2>
    </div>

    <div class="box">
      <h3 class="box-title" id="/default-options/">
        <a href="{{ path }}#/default-options/">Default Options</a>
      </h3>
      <p>Default options provided to Perfume.js constructor.</p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                <pre><span class="red">const</span> <span class="blue">options</span> <span class="red">=</span> {{'{'}}
  <span class="gray">// Metrics</span>
  firstContentfulPaint<span class="red">:</span> <span class="blue">false</span>,
  firstPaint<span class="red">:</span> <span class="blue">false</span>
  firstInputDelay<span class="red">:</span> <span class="blue">false</span>,
  <span class="gray">// Analytics</span>
  analyticsTracker<span class="red">:</span> <span class="blue">undefined</span>,
  googleAnalytics<span class="red">:</span> {{'{'}}
    enable<span class="red">:</span> <span class="blue">false</span>,
    timingVar<span class="red">:</span> "name"
  {{'}'}},
  <span class="gray">// Logging</span>
  logPrefix<span class="red">:</span> "Perfume.js:"
  logging<span class="red">:</span> <span class="blue">true</span>,
  maxMeasureTime<span class="red">:</span> 18000,
  warning<span class="red">:</span> <span class="blue">false</span>,
  debugging<span class="red">:</span> <span class="blue">false</span>,
{{'}'}};</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="box">
      <h3 class="box-title" id="/utilities/">
        <a href="{{ path }}#/utilities/">Utilities</a>
      </h3>
      <p>Perfume.js expose some methods and properties which may be useful to people extending the library.</p>
      <div class="box-code js">
        <table>
          <tbody>
            <tr>
              <td class="code">
                  <pre><span class="red">const</span> <span class="blue">perfume</span> <span class="red">= new</span> <span class="violet">Perfume</span>({{'{'}}
  firstContentfulPaint<span class="red">:</span> <span class="blue">true</span>,
  firstInputDelay<span class="red">:</span> <span class="blue">true</span>,
{{'}'}});

<span class="gray">// Values</span>
perfume.firstPaintDuration;
perfume.firstContentfulPaintDuration;
perfume.firstInputDelayDuration;

<span class="gray">// Async/Await Values (don't forget to use "async" with "await")</span>
<span class="blue">const</span> durationFCP <span class="red">= await</span> perfume.<span class="blue">observeFirstContentfulPaint</span>;
<span class="blue">const</span> durationFID <span class="red">= await</span> perfume.<span class="blue">observeFirstInputDelay</span>;

<span class="gray">// Send Custom User timing measure to Google Analytics</span>
perfume.<span class="blue">sendTiming</span>(metricName, durationFCP);</pre>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="box">
      <h3 class="box-title" id="/articles/">
        <a href="{{ path }}#/articles/">Articles</a>
      </h3>
      <ul>
        <li>
          <a href="https://medium.com/@zizzamia/first-contentful-paint-with-a-touch-of-perfume-js-cd11dfd2e18f" 
          target="_blank">First (Contentful) Paint with a touch of Perfume(.js)</a>
        </li>
        <li>
          <a href="https://medium.com/@zizzamia/time-to-interactive-with-rum-862ba874392c" 
          target="_blank">Time to Interactive with RUM</a>
        </li>
      </ul>
    </div>

    <div class="box">
      <h2 class="box-title">Contacts</h2>
    </div>

    <div class="box">
      <h3 class="box-title" id="/copyright-and-license/">
        <a href="{{ path }}#/copyright-and-license/">Copyright and licenses</a>
      </h3>
      <p>Code and documentation copyright 2018
        <a href="https://twitter.com/Zizzamia" target="_blank">Leonardo Zizzamia</a>. Code released under the
        <a href="https://github.com/Zizzamia/perfume.js/blob/master/LICENSE" target="_blank">MIT license</a>. Docs released under Creative Commons.</p>
    </div>

    <div class="box">
      <a href="https://twitter.com/Zizzamia" class="box-leo" target="_blank">
        <picture class="logo">
          <source srcset="{{ path }}assets/leo.webp" type="image/webp" />
          <source srcset="{{ path }}assets/leo.jpg" type="image/jpeg" />
          <img src="{{ path }}assets/leo.jpg" alt="Leonardo Zizzamia" />
        </picture>
        <div>
          <h3>Leonardo Zizzamia</h3>
          <h4>
            Co-Founder of Plan, Google Developer Expert in Web Technologies & Angular. <br />
            International speaker. Ex Twitter & Framestore
          </h4>
        </div>
      </a>
    </div>

    <div class="box Fibonacci"></div>
  </div>
  <app-navigation></app-navigation>
</div>
